import pandas as pd
import numpy as np
import matplotlib.pyplot as plt
import seaborn as sns

# --- 1. Carregamento e Exploração Inicial ---
print("--- 1. Carregamento e Exploração Inicial ---")
print("Carregando o dataset 'data.csv'...")

try:
    # Carregar o dataset (Assumindo que o arquivo 'data.csv' está no mesmo diretório ou acessível)
    df = pd.read_csv('breast-cancer.csv')
except FileNotFoundError:
    print("ERRO: O arquivo 'data.csv' não foi encontrado. Verifique o caminho.")
    exit()

# Mostrar as 5 primeiras linhas
print("\n1.1. As 5 primeiras linhas do dataset:")
print(df.head())

# --- 2. Informações Gerais e Estatísticas Descritivas ---
print("\n--- 2. Informações Gerais e Estatísticas Descritivas ---")

# Exibir informações gerais (.info())
print("\n2.1. Informações Gerais do DataFrame (.info()):")
df.info()

# Exibir estatísticas descritivas (.describe())
print("\n2.2. Estatísticas Descritivas das Colunas Numéricas (.describe()):")
print(df.describe().T) # Usamos .T para melhor visualização

# --- 3. Verificação de Valores Nulos e Duplicados ---
print("\n--- 3. Verificação de Valores Nulos e Duplicados ---")

# Verificar a contagem de valores nulos por coluna
print("\n3.1. Contagem de Valores Nulos:")
null_counts = df.isnull().sum()
print(null_counts[null_counts > 0]) # Mostrar apenas colunas com valores nulos

# Verificar a contagem de linhas duplicadas
print(f"\n3.2. Total de linhas duplicadas: {df.duplicated().sum()}")

# --- 4. Análise da Distribuição da Variável Alvo ('diagnosis') ---
print("\n--- 4. Análise da Distribuição da Variável Alvo ('diagnosis') ---")

# Contagem de valores
target_counts = df['diagnosis'].value_counts()
print("\n4.1. Distribuição de Frequência da 'diagnosis':")
print(target_counts)

# Visualização da distribuição
plt.figure(figsize=(7, 5))
sns.countplot(x='diagnosis', data=df, palette='pastel')
plt.title('Distribuição de Tumores (Benignos vs. Malignos)')
plt.xlabel('Diagnosis (M=Maligno, B=Benigno)')
plt.ylabel('Contagem')
plt.grid(axis='y', alpha=0.5)
plt.show()

# Cálculo da porcentagem
total = target_counts.sum()
pct_malignant = (target_counts['M'] / total) * 100
pct_benign = (target_counts['B'] / total) * 100

print(f"4.2. Porcentagem de Malignos (M): {pct_malignant:.2f}%")
print(f"Porcentagem de Benignos (B): {pct_benign:.2f}%")

# --- 5. Identificação e Preparação de Variáveis Preditoras (X) e Alvo (Y) ---
print("\n--- 5. Identificação e Preparação de Variáveis (Features e Alvo) ---")

# 5.1. Remoção de colunas desnecessárias/vazias
# 'id' é um identificador e 'Unnamed: 32' está vazia
cols_to_drop = ['id'] # 'Unnamed: 32' não está presente no dataset carregado
df_clean = df.drop(columns=cols_to_drop)
print(f"Colunas removidas: {cols_to_drop}")

# 5.2. Codificação da Variável Alvo (Label Encoding)
# M (Maligno) -> 1
# B (Benigno) -> 0
df_clean['diagnosis_encoded'] = df_clean['diagnosis'].map({'M': 1, 'B': 0})

# 5.3. Separação de Variáveis Preditoras (X) e Variável Alvo (Y)
# X: Todas as colunas numéricas (Features)
# Y: Coluna 'diagnosis_encoded' (Alvo)

# Variáveis Preditoras (Features)
X = df_clean.drop(columns=['diagnosis', 'diagnosis_encoded'])

# Variável Alvo
Y = df_clean['diagnosis_encoded']

print("\n5.4. Resultado da Separação:")
print(f"Variável Alvo (Y): {Y.name}")
print(f"Shape de X (Preditoras): {X.shape}")
print(f"Shape de Y (Alvo): {Y.shape}")
print("\nPrimeiras 3 Linhas das Features (X):")
print(X.head(3))
print("\nPrimeiras 3 Linhas do Alvo Codificado (Y):")
print(Y.head(3))
